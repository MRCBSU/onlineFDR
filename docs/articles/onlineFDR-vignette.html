<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Managing multiple testing challenges with sequential inference using the onlineFDR package • onlineFDR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Managing multiple testing challenges with sequential inference using the onlineFDR package">
<meta property="og:description" content="onlineFDR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">onlineFDR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/onlineFDR-vignette.html">Managing multiple testing challenges with sequential inference using the onlineFDR package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="onlineFDR-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Managing multiple testing challenges with sequential inference using the onlineFDR package</h1>
                        <h4 class="author">David S. Robertson, Aaditya Ramdas and Natasha A. Karp</h4>
            
            <h4 class="date">2019-10-23</h4>
      
      
      <div class="hidden name"><code>onlineFDR-vignette.Rmd</code></div>

    </div>

    
    
<hr>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Multiple hypothesis testing is a fundamental problem in statistical inference. The failure to manage the multiple testing problem has been highlighted as one of the elements contributing to the replicability crisis in science (Ioannidis 2015). Methodologies have been developed for a family of hypotheses to adjust the significance levels to manage the multiple testing situation by controlling error metrics such as the familywise error rate (FWER) or the false discovery rate (FDR).</p>
<p>Frequently, modern data analysis problems have a further complexity that the hypothesis arrive sequentially in a stream. This introduces the challenge that at each step the investigator must decide whether to reject the current null hypothesis without having access to the future p-values or the total number of hypothesis to be tested, but does have knowledge of the historic decisions to date. The International Mouse Phenotyping Consortium (Koscielny <em>et al.</em>, 2013), provides a concrete example of such a scenario. Here the dataset is constantly growing as new knockout mice lines are generated and phenotyping data uploaded to a database.</p>
<p>Javanmard and Montanari proposed two procedures, LOND and LORD, to control the FDR in an online manner (Javanmard and Montanari (2015, 2018)), with the latter extended by Ramdas <em>et al.</em> (2017). The LOND procedure sets the adjusted significance thresholds based on the number of discoveries made so far, while LORD sets them according to the time of the most recent discovery. Ramdas <em>et al.</em> (2018) then proposed the SAFFRON procedure, which provides an adaptive method of online FDR control. They also proposed a variant of the Alpha-investing algorithm of Foster and Stine (2008) that guarantees FDR control, using SAFFRON’s update rule.</p>
<p>Subsequently, Zrnic <em>et al.</em> (2018) proposed procedures to control the modified FDR (mFDR) in the context of <em>asynchronous</em> testing, i.e. where each hypothesis test can itself be a sequential process and the tests can overlap in time. They presented asynchronous versions of the LOND, LORD and SAFFRON procedures for a variety of trial settings. For both synchronous and asynchronous testing, Tian &amp; Ramdas (2019a) proposed the ADDIS algorithms which compensate for the loss in power in the presence of conservative nulls by adaptively ‘discarding’ these p-values.</p>
<p>Finally, Tian &amp; Ramdas (2019b) proposed procedures that provide online control of the FWER. One procedure, online fallback, gives a uniform improvement to the naive Alpha-spending procedure (see below). The ADDIS-spending procedure compensates for the power loss of these procedures by including both adapativity in the fraction of null hypotheses and the conservativeness of nulls.</p>
<p>The onlineFDR package implements all these procedures and provides wrapper functions to apply them to a historic or growing dataset. As a comparison, we have also provided a function for implementation of the Alpha-spending procedure, which is based on the Bonferroni procedure adapted to the online scenario. This vignette explains the use of the package and demonstrates a typical workflow.</p>
<hr>
</div>
<div id="overview-of-the-process" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-the-process" class="anchor"></a>Overview of the process</h2>
<ol style="list-style-type: decimal">
<li><p>A dataset with three columns (an identifier (‘id’), date (‘date’) and p-value (‘pval’)) is passed to one of the onlineFDR wrapper functions. Alternatively, a vector of p-values can be provided, in which case step 2 is skipped.</p></li>
<li><p>The function orders the information by date. If there are multiple p-values with the same date (i.e. the same batch), the order of the p-values within each batch is randomised by default. In order for the randomisation of the p-values to be reproducible, it is necessary to set a seed (via the <code>set.seed</code> function) before calling the wrapper function (see also step 6).</p></li>
<li><p>For each hypothesis test, an adjusted significance threshold (<code>alphai</code>) is calculated, which gives the threshold at which the corresponding p-value would be declared significant.</p></li>
<li><p>Using the p-values provided and the alphai, an indicator of discoveries (<code>R</code>) is calculated, where <code>R[i] = 1</code> corresponds to hypothesis i being rejected (and <code>R[i] = 0</code> otherwise).</p></li>
<li><p>A dataframe is returned, reordered by batch, with the original data and the newly calculated <code>alphai</code> and <code>R</code>.</p></li>
<li><p>For simplicity, as the dataset grows the new larger dataset should be passed to the wrapper function and the values recalculated repeating steps 1 to 5. In order for the randomisation of the data within the previous batches to remain the same (and hence to allow for reproducibility of the results), <em>the same seed should be used for all analyses</em>.</p></li>
</ol>
<div id="outline-of-the-functions-available" class="section level3">
<h3 class="hasAnchor">
<a href="#outline-of-the-functions-available" class="anchor"></a>Outline of the functions available</h3>
<p>1: <strong>LOND</strong> Implements the LOND procedure for online FDR control, where LOND stands for (significance) Levels based On Number of Discoveries, as presented by Javanmard and Montanari (2015). The procedure controls the FDR for independent or positively dependent (PRDS) p-values, with an option (dep = TRUE) which guarantees control for arbitrarily dependent p-values.</p>
<p>2: <strong>LORD</strong> Implements the LORD procedure for online FDR control, where LORD stands for (significance) Levels based On Recent Discovery, as presented by Javanmard and Montanari (2018), Ramdas <em>et al.</em> (2017) and Tian &amp; Ramdas (2019). The function provides different versions of the procedure valid for independent p-values, see ‘Theory behind onlineFDR’. There is also a version (‘dep’) that guarantees control for dependent p-values.</p>
<p>3: <strong>SAFFRON</strong> Implements the SAFFRON procedure for online FDR control, where SAFFRON stands for Serial estimate of the Alpha Fraction that is Futilely Rationed On true Null hypotheses, as presented by Ramdas <em>et al.</em> (2018). The procedure provides an adaptive method of online FDR control.</p>
<p>4: <strong>ADDIS</strong> Implements the ADDIS algorithm for online FDR control, where ADDIS stands for an ADaptive algorithm that DIScards conservative nulls, as presented by Tian &amp; Ramdas (2019). The algorithm compensates for the power loss of SAFFRON with conservative nulls, by including both adapativity in the fraction of null hypotheses (like SAFFRON) and the conservativeness of nulls (unlike SAFFRON). This procedure controls the FDR for independent p-values.</p>
<p>5: <strong>Alpha_investing</strong> Implements a variant of the Alpha-investing algorithm of Foster and Stine (2008) that guarantees FDR control, as proposed by Ramdas et al. (2018). This procedure uses a variant of SAFFRON’s update rule. This procedure controls the FDR for independent p-values.</p>
<p>6: <strong>LONDstar</strong> Implements the LOND algorithm for asynchronous online testing, as presented by Zrnic <em>et al.</em> (2018). These algorithms control the mFDR.</p>
<p>7: <strong>LORDstar</strong> Implements LORD algorithms for asynchronous online testing, as presented by Zrnic <em>et al.</em> (2018). These algorithms control the mFDR.</p>
<p>8: <strong>SAFFRONstar</strong> Implements the SAFFRON algorithm for asynchronous online testing, as presented by Zrnic <em>et al.</em> (2018). These algorithms control the mFDR.</p>
<p>9: <strong>Alpha_spending</strong> Implements online FWER control using a Bonferroni-like test. Alpha-spending provides strong FWER control for arbitrarily dependent p-values.</p>
<p>10: <strong>online_fallback</strong> Implements the online fallback algorithm for FWER control, as proposed by Tian &amp; Ramdas (2019b). Online fallback is a uniformly more powerful method than Alpha-spending, as it saves the significance level of a previous rejection. Online fallback strongly controls the FWER for arbitrarily dependent p-values.</p>
<p>11: <strong>ADDIS-spending</strong> Implements the ADDIS-spending algorithm for online FWER control, as proposed by Tian &amp; Ramdas (2019b). The algorithm compensates for the power loss of Alpha-spending, by including both adapativity in the fraction of null hypotheses and the conservativeness of nulls. ADDIS-spending provides strong FWER control for independent p-values. Tian &amp; Ramdas (2019b) also presented a version for handling local dependence.</p>
</div>
<div id="quick-start" class="section level3">
<h3 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h3>
<p>Here we show the steps to achieve online FDR control of a growing dataset. First load a dataframe with the three columns: an identifier (‘id’), date (‘date’) and p-value (‘pval’), and then call the wrapper function of interest. In order for the results to be reproducible, we also set a seed using the <code>set.seed</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dsrobertson.github.io/onlineFDR/index.html">onlineFDR</a></span><span class="op">)</span>

<span class="va">sample.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A15432'</span>, <span class="st">'B90969'</span>, <span class="st">'C18705'</span>, <span class="st">'B49731'</span>, <span class="st">'E99902'</span>,
        <span class="st">'C38292'</span>, <span class="st">'A30619'</span>, <span class="st">'D46627'</span>, <span class="st">'E29198'</span>, <span class="st">'A41418'</span>,
        <span class="st">'D51456'</span>, <span class="st">'C88669'</span>, <span class="st">'E03673'</span>, <span class="st">'A63155'</span>, <span class="st">'B66033'</span><span class="op">)</span>,
    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2014-12-01"</span>,<span class="fl">3</span><span class="op">)</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2015-09-21"</span>,<span class="fl">5</span><span class="op">)</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2016-05-19"</span>,<span class="fl">2</span><span class="op">)</span>,
                    <span class="st">"2016-11-12"</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"2017-03-27"</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    pval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.90e-14</span>, <span class="fl">0.06743</span>, <span class="fl">0.01514</span>, <span class="fl">0.08174</span>, <span class="fl">0.00171</span>,
            <span class="fl">3.61e-05</span>, <span class="fl">0.79149</span>, <span class="fl">0.27201</span>, <span class="fl">0.28295</span>, <span class="fl">7.59e-08</span>,
            <span class="fl">0.69274</span>, <span class="fl">0.30443</span>, <span class="fl">0.000487</span>, <span class="fl">0.72342</span>, <span class="fl">0.54757</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span><span class="op">)</span>
<span class="va">results</span>
<span class="co">#&gt;        id       date       pval       alphai R</span>
<span class="co">#&gt; 1  A15432 2014-12-01 2.9000e-14 0.0002675839 1</span>
<span class="co">#&gt; 2  B90969 2014-12-01 6.7430e-02 0.0024664457 0</span>
<span class="co">#&gt; 3  C18705 2014-12-01 1.5140e-02 0.0005732818 0</span>
<span class="co">#&gt; 4  B49731 2015-09-21 8.1740e-02 0.0004872805 0</span>
<span class="co">#&gt; 5  E99902 2015-09-21 1.7100e-03 0.0004059066 0</span>
<span class="co">#&gt; 6  D46627 2015-09-21 2.7201e-01 0.0003447286 0</span>
<span class="co">#&gt; 7  C38292 2015-09-21 3.6100e-05 0.0002986627 1</span>
<span class="co">#&gt; 8  A30619 2015-09-21 7.9149e-01 0.0029389397 0</span>
<span class="co">#&gt; 9  A41418 2016-05-19 7.5900e-08 0.0008168502 1</span>
<span class="co">#&gt; 10 E29198 2016-05-19 2.8295e-01 0.0033835974 0</span>
<span class="co">#&gt; 11 D51456 2016-11-12 6.9274e-01 0.0011873999 0</span>
<span class="co">#&gt; 12 A63155 2017-03-27 7.2342e-01 0.0010225858 0</span>
<span class="co">#&gt; 13 C88669 2017-03-27 3.0443e-01 0.0008785607 0</span>
<span class="co">#&gt; 14 B66033 2017-03-27 5.4757e-01 0.0007679398 0</span>
<span class="co">#&gt; 15 E03673 2017-03-27 4.8700e-04 0.0006820264 1</span></pre></div>
</div>
<div id="input-data" class="section level3">
<h3 class="hasAnchor">
<a href="#input-data" class="anchor"></a>Input data</h3>
<p>A dataset with three columns (an identifier (‘id’), date (‘date’) and p-value (‘pval’)). All p-values generated should be passed to the function (and not just the significant p-values). An exception to this would be if you have implemented an orthogonal filter to reduce the dataset size, such as discussed in (Burgon <em>et al.</em>, 2010).</p>
<p>Alternatively, just the vector of p-values can be passed to the function. In this case, the p-values are treated as being ordered sequentially with no batches.</p>
</div>
<div id="understanding-the-output" class="section level3">
<h3 class="hasAnchor">
<a href="#understanding-the-output" class="anchor"></a>Understanding the output</h3>
<p>For each hypothesis test, the functions calculate the adjusted significance thresholds (<code>alphai</code>) at which the corresponding p-value would be declared statistically significant.</p>
<p>Also calculated is an indicator function of discoveries (<code>R</code>), where <code>R[i] = 1</code> corresponds to hypothesis i being rejected, otherwise <code>R[i] = 0</code>.</p>
<p>A dataframe is returned, reordered by batch, with the original data and the newly calculated <code>alphai</code> and <code>R</code>.</p>
<hr>
</div>
</div>
<div id="how-to-get-help-for-onlinefdr" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-get-help-for-onlinefdr" class="anchor"></a>How to get help for onlineFDR</h2>
<p>All questions regarding onlineFDR should be posted to the <strong>Bioconductor support site</strong>, which serves as a searchable knowledge base of questions and answers:</p>
<p><a href="https://support.bioconductor.org" class="uri">https://support.bioconductor.org</a></p>
<p>Posting a question and tagging with “onlineFDR” will automatically send an alert to the package authors to respond on the support site.</p>
<hr>
</div>
<div id="theory-behind-onlinefdr" class="section level2">
<h2 class="hasAnchor">
<a href="#theory-behind-onlinefdr" class="anchor"></a>Theory behind onlineFDR</h2>
<div id="online-hypothesis-testing" class="section level3">
<h3 class="hasAnchor">
<a href="#online-hypothesis-testing" class="anchor"></a>Online hypothesis testing</h3>
<p>Consider a sequence of hypotheses <span class="math inline">\(H_1, H_2, H_3, \ldots\)</span> that arrive sequentially in a stream, with corresponding <span class="math inline">\(p\)</span>-values <span class="math inline">\((p_1, p_2, p_3, \ldots)\)</span>. A testing procedure provides a sequence of adjusted significance thresholds <span class="math inline">\(\alpha_i\)</span>, with corresponding decision rule: <span class="math display">\[ R_i = \begin{cases}
1 &amp; \text{if } p_i \leq \alpha_i &amp; (\text{reject } H_i)\\
0 &amp; \text{otherwise} &amp; (\text{accept } H_i)
\end{cases} \]</span></p>
<p>In <em>online</em> testing, the significance thresholds can only be functions of the prior decisions, i.e. <span class="math inline">\(\alpha_i = \alpha_i(R_1, R_2, \ldots, R_{i-1})\)</span>.</p>
<p>Javanmard and Montanari (2015, 2018) proposed two procedures for online control. The first is LOND, which stands for (significance) Levels based On Number of Discoveries. The second is LORD, which stands for (significance) Levels based On Recent Discovery. LORD was subsequently extended by Ramdas <em>et al.</em> (2017). Ramdas <em>et al.</em> (2018) also proposed the SAFFRON procedure, which provides an adaptive method of online FDR control, which includes a variant of Alpha-investing. Finally, Tian &amp; Ramdas (2019) proposed the ADDIS procedure as an improvement of SAFFRON in the presence of conservative nulls.</p>
</div>
<div id="LOND" class="section level3">
<h3 class="hasAnchor">
<a href="#LOND" class="anchor"></a>LOND</h3>
<p>The LOND procedure controls the FDR for independent or positively dependent (PRDS) <span class="math inline">\(p\)</span>-values. Given an overall significance level <span class="math inline">\(\alpha\)</span>, we choose a sequence of non-negative numbers <span class="math inline">\(\beta = (\beta_i)_{i \in \mathbb{N}}\)</span> such that they sum to <span class="math inline">\(\alpha\)</span>. The values of the adjusted significance thresholds <span class="math inline">\(\alpha_i\)</span> are chosen as follows: <span class="math display">\[ \alpha_i = \beta_i (D(i-1) + 1) \]</span> where <span class="math inline">\(D(n) = \sum_{i=1}^n R_i\)</span> denotes the number of discoveries (i.e. rejections) in the first <span class="math inline">\(n\)</span> hypotheses tested.</p>
<p>LOND can be adjusted to also control FDR under arbitrarily dependent <span class="math inline">\(p\)</span>-values. To do so, it is modified with <span class="math inline">\(\tilde{\beta}_i = \beta_i/H(i)\)</span> in place of <span class="math inline">\(\beta_i\)</span>, where <span class="math inline">\(H(i) = \sum_{j=1}^i \frac{1}{j}\)</span> is the <span class="math inline">\(i\)</span>-th harmonic number. Note that this leads to a substantial loss in power compared to the unadjusted LOND procedure. The correction factor is similar to the classical one used by Benjamini and Yekutieli (2001), except that in this case the <span class="math inline">\(i\)</span>-th hypothesis among <span class="math inline">\(N\)</span> is penalised by a factor of <span class="math inline">\(H(i)\)</span> to give consistent results across time (as compared to a factor <span class="math inline">\(H(N)\)</span> for the Benjamini and Yekutieli method).</p>
<p><a name="LOND_beta"></a> The default sequence of <span class="math inline">\(\beta\)</span> is given by <span class="math display">\[\beta_j = C \alpha \frac{\log(\max(j, 2))}{j e^{\sqrt{\log j}}}\]</span> where <span class="math inline">\(C \approx 0.07720838\)</span>, as proposed by Javanmard and Montanari (2018) equation 31.</p>
</div>
<div id="LORD" class="section level3">
<h3 class="hasAnchor">
<a href="#LORD" class="anchor"></a>LORD</h3>
<p>The LORD procedure controls the FDR for independent <span class="math inline">\(p\)</span>-values. We first fix a sequence of non-negative numbers <span class="math inline">\(\gamma = (\gamma_i)_{i \in \mathbb{N}}\)</span> such that <span class="math inline">\(\gamma_i \geq \gamma_j\)</span> for <span class="math inline">\(i \leq j\)</span> and <span class="math inline">\(\sum_{i=1}^{\infty} \gamma_i = 1\)</span>. At each time <span class="math inline">\(i\)</span>, let <span class="math inline">\(\tau_i\)</span> be the last time a discovery was made before <span class="math inline">\(i\)</span>: <span class="math display">\[
\tau_i = \max \left\{ l \in \{1, \ldots, i-1\} : R_l = 1\right\}
\]</span></p>
<p>LORD depends on constants <span class="math inline">\(w_0\)</span> and <span class="math inline">\(b_0\)</span>, where <span class="math inline">\(w_0 \geq 0\)</span> represents the initial ‘wealth’ of the procedure and <span class="math inline">\(b_0 &gt; 0\)</span> represents the ‘payout’ for rejecting a hypothesis. We require <span class="math inline">\(w_0+b_0 \leq \alpha\)</span> for FDR control to hold.</p>
<p>Javanmard and Montanari (2018) presented three different versions of LORD, which have different definitions of the adjusted significance thresholds <span class="math inline">\(\alpha_i\)</span>. Versions 1 and 2 have since been superseded by the LORD++ procedure of Ramdas <em>et al.</em> (2017), so we do not describe them here.</p>
<ul>
<li><p><strong>LORD++</strong>: The significance thresholds for LORD++ are chosen as follows: <span class="math display">\[
\alpha_i = \gamma_i w_0 + (\alpha - w_0) \gamma_{i-\tau_1} + 
\alpha \sum_{j : \tau_j &lt; i, \tau_j \neq \tau_1} \gamma_{i - \tau_j}
\]</span></p></li>
<li><p><strong>LORD 3</strong>: The significance thresholds depend on the time of the last discovery time and the wealth accumulated at that time, with <span class="math display">\[
\alpha_i  = \gamma_{i - \tau_i} W(\tau_i)
\]</span> where <span class="math inline">\(\tau_1 = 0\)</span>. Here <span class="math inline">\(\{W(j)\}_{j \geq 0}\)</span> represents the ‘wealth’ available at time <span class="math inline">\(j\)</span>, and is defined recursively: <span class="math display">\[
\begin{align}
W(0) &amp; = w_0 \nonumber \\
W(j) &amp; = W(j-1) - \alpha_{j-1} + b_0 R_j
\end{align}
\]</span></p></li>
<li><p><strong>D-LORD</strong>: This is equivalent to the LORD++ procedure with discarding. Given a discarding threshold <span class="math inline">\(\tau \in (0,1)\)</span> and initial wealth <span class="math inline">\(w_0 \leq \tau\alpha\)</span> the significance thresholds are chosen as follows: <span class="math display">\[ 
\alpha_t = \min\{\tau, \tilde{\alpha}_t\}
\]</span> where <span class="math display">\[
\tilde{\alpha}_t = w_0 \gamma_{S^t} +
(\tau\alpha - w_0)\gamma_{S^t - \kappa_1^*} + 
\tau\alpha \sum_{j \geq 2} \gamma_{S^t - \kappa_j^*}
\]</span> and <span class="math display">\[
\kappa_j = \min\{i \in [t-1] : \sum_{k \leq i} 
1 \{p_k \leq \alpha_k\} \geq j\}, \;
\kappa_j^* = \sum_{i \leq \kappa_j} 1 \{p_i \leq \tau \}, \;
S^t = \sum_{i &lt; t} 1 \{p_i \leq \tau \}
\]</span></p></li>
</ul>
<p>LORD++ is an instance of a monotone rule, and provably controls the FDR for independent p-values provided <span class="math inline">\(w_0 \leq \alpha\)</span>. LORD 3 is a non-monotone rule, and FDR control is only demonstrated empirically. In some scenarios with large <span class="math inline">\(N\)</span>, LORD 3 will have a slightly higher power than LORD++ (see Robertson <em>et al.</em>, 2018), but since it is a non-monotone rule we would recommend using LORD++ (which is the default), especially since it also has a provable guarantee of FDR control.</p>
<p><a name="LORD_gamma"></a> In all versions, the default sequence of <span class="math inline">\(\gamma\)</span> is given by <span class="math display">\[\gamma_j = C \frac{\log(\max(j, 2))}{j e^{\sqrt{\log j}}}\]</span> where <span class="math inline">\(C \approx 0.07720838\)</span>, as proposed by Javanmard and Montanari (2018) equation 31.</p>
<p>Javanmard and Montanari (2018) also proposed an adjusted version of LORD that is valid for arbitrarily <em>dependent</em> p-values. Similarly to LORD 3, the adjusted significance thresholds are set equal to <span class="math display">\[ \alpha_i = \xi_i W(\tau_i)\]</span> where (assuming <span class="math inline">\(w_0 \leq b_0\)</span>), <span class="math inline">\(\sum_{j=1}^{\infty} \xi_i (1 + \log(j)) \leq \alpha / b_0\)</span></p>
<p><a name="LORDdep_xi"></a> The default sequence of <span class="math inline">\(\xi\)</span> is given by <span class="math display">\[ \xi_j  = \frac{C \alpha }{b_0 j \log(\max(j, 2))^3}\]</span> where <span class="math inline">\(C \approx 0.139307\)</span>.</p>
<p>Note that allowing for dependent p-values can lead to a substantial loss in power compared with the LORD procedures described above.</p>
</div>
<div id="SAFFRON" class="section level3">
<h3 class="hasAnchor">
<a href="#SAFFRON" class="anchor"></a>SAFFRON</h3>
<p>The SAFFRON procedure controls the FDR for independent p-values, and was proposed by Ramdas <em>et al.</em> (2018). The algorithm is based on an estimate of the proportion of true null hypotheses. More precisely, SAFFRON sets the adjusted test levels based on an estimate of the amount of alpha-wealth that is allocated to testing the true null hypotheses.</p>
<p>SAFFRON depends on constants <span class="math inline">\(w_0\)</span> and <span class="math inline">\(\lambda\)</span>, where <span class="math inline">\(w_0\)</span> satisfies <span class="math inline">\(0 \leq w_0 &lt; (1 - \lambda)\alpha\)</span> and represents the initial ‘wealth’ of the procedure, and <span class="math inline">\(\lambda \in (0,1)\)</span> represents the threshold for a ‘candidate’ hypothesis. A ‘candidate’ refers to p-values smaller than <span class="math inline">\(\lambda\)</span>, since SAFFRON will never reject a p-value larger than <span class="math inline">\(\lambda\)</span>. These candidates can be thought of as the hypotheses that are a-priori more likely to be non-null.</p>
<p>The SAFFRON procedure runs as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Set the initial alpha-wealth <span class="math inline">\(w_0 &lt; (1-\lambda)\alpha\)</span></p></li>
<li><p>At each time <span class="math inline">\(i\)</span>, define the number of candidates after the <span class="math inline">\(k\)</span>-th rejection as <span class="math display">\[ C_{k+} = C_{k+}(i) = \sum_{j = \tau_k + 1}^{i-1} C_j\]</span> where <span class="math inline">\(C_j = 1\{p_j \leq \lambda \}\)</span> is the indicator for candidacy.</p></li>
<li><p>SAFFRON starts with <span class="math inline">\(\alpha_1 = \min\{\gamma_1 w_0, \lambda\}\)</span>. Subsequent test levels are chosen as <span class="math inline">\(\alpha_i = \min\{ \lambda, \tilde{\alpha}_i\}\)</span>, where <span class="math display">\[
\tilde{\alpha}_i = w_0 \gamma_{i-C_{0+}} + 
((1-\lambda)\alpha - w_0)\gamma_{i-\tau_1-C_{1+}} +
(1-\lambda)\alpha \sum_{j : \tau_j &lt; i, \tau_j \neq \tau_1} 
\gamma_{i - \tau_j- C_{j+}}
\]</span></p></li>
</ol>
<p><a name="SAFFRON_gamma"></a> The default sequence of <span class="math inline">\(\gamma\)</span> for SAFFRON is given by <span class="math inline">\(\gamma_j \propto j^{-1.6}\)</span>.</p>
</div>
<div id="AlphaInvesting" class="section level3">
<h3 class="hasAnchor">
<a href="#AlphaInvesting" class="anchor"></a>Alpha-investing</h3>
<p>Ramdas et al. (2018) proposed a variant of the Alpha-investing algorithm of Foster and Stine (2008) that guarantees FDR control for independent p-values. This procedure uses SAFFRON’s update rule with the constant  replaced by a sequence <span class="math inline">\(\lambda_i = \alpha_i\)</span>. This is also equivalent to using the ADDIS algorithm (see below) with <span class="math inline">\(\tau = 1\)</span> and <span class="math inline">\(\lambda_i = \alpha_i\)</span>.</p>
</div>
<div id="ADDIS" class="section level3">
<h3 class="hasAnchor">
<a href="#ADDIS" class="anchor"></a>ADDIS</h3>
<p>The ADDIS procedure controls the FDR for independent p-values, and was proposed by Tian &amp; Ramdas (2019). The algorithm compensates for the power loss of SAFFRON with conservative nulls, by including both adapativity in the fraction of null hypotheses (like SAFFRON) and the conservativeness of nulls (unlike SAFFRON).</p>
<p>ADDIS depends on constants <span class="math inline">\(w_0, \lambda\)</span> and <span class="math inline">\(\tau\)</span>. <span class="math inline">\(w_0\)</span> represents the initial `wealth’ of the procedure and satisfies <span class="math inline">\(0 \leq w_0 \leq \tau \lambda \alpha\)</span>. <span class="math inline">\(\tau \in (0,1)\)</span> represents the threshold for a hypothesis to be selected for testing: p-values greater than <span class="math inline">\(\tau\)</span> are implicitly ‘discarded’ by the procedure. Finally, <span class="math inline">\(\lambda \in (0,1)\)</span> sets the threshold for a p-value to be a candidate for rejection: ADDIS will never reject a p-value larger than <span class="math inline">\(\tau \lambda\)</span>.</p>
<p>The significance thresholds for ADDIS are chosen as follows: <span class="math display">\[ 
\alpha_t = \min\{\tau\lambda, \tilde{\alpha}_t\}
\]</span> where <span class="math display">\[
\tilde{\alpha}_t = w_0 \gamma_{S^t-C_{0+}} +
(\tau(1-\lambda)\alpha - w_0)\gamma_{S^t - \kappa_1^*-C_{1+}} + 
\tau(1-\lambda)\alpha \sum_{j \geq 2} \gamma_{S^t - \kappa_j^* - C_{j+}}
\]</span> and <span class="math display">\[
\kappa_j = \min\{i \in [t-1] : \sum_{k \leq i} 
1 \{p_k \leq \alpha_k\} \geq j\}, \;
\kappa_j^* = \sum_{i \leq \kappa_j} 1 \{p_i \leq \tau \}, \;
S^t = \sum_{i &lt; t} 1 \{p_i \leq \tau \}, \;
C_{j+} = \sum_{i = \tau_k + 1}^{t-1} 1\{p_i \leq \tau\}
\]</span></p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span> for ADDIS is the same as for SAFFRON given <a href="#SAFFRON_gamma">here</a>.</p>
</div>
<div id="Alpha-spending" class="section level3">
<h3 class="hasAnchor">
<a href="#Alpha-spending" class="anchor"></a>Alpha-spending</h3>
<p>The Alpha-spending procedure controls the FWER for a potentially infinite stream of p-values using a Bonferroni-like test. Given an overall significance level <span class="math inline">\(\alpha\)</span>, the significance thresholds are chosen as <span class="math display">\[\alpha_i = \alpha \gamma_i\]</span> where <span class="math inline">\(\sum_{i=1}^{\infty} \gamma_i = 1\)</span> and <span class="math inline">\(\gamma_i \geq 0\)</span>. The procedure strongly controls the FWER for arbitrarily dependent p-values.</p>
<p>Note that the procedure also controls the generalised familywise error rate (k-FWER) for <span class="math inline">\(k &gt; 1\)</span> if <span class="math inline">\(\alpha\)</span> is replaced by <span class="math inline">\(\min(1,k\alpha)\)</span>.</p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span> is the same as that for <span class="math inline">\(\xi\)</span> for LORD given <a href="#LORD_gamma">here</a>.</p>
</div>
<div id="onlineFallback" class="section level3">
<h3 class="hasAnchor">
<a href="#onlineFallback" class="anchor"></a>Online Fallback</h3>
<p>The online fallback procedure of Tian &amp; Ramdas (2019b) provides a uniformly more powerful method than Alpha-spending, by saving the significance level of a previous rejection. More specifically, online fallback tests hypothesis <span class="math inline">\(H_i\)</span> at level <span class="math display">\[\alpha_i = \alpha \gamma_i + R_{i-1} \alpha_{i-1}\]</span> where <span class="math inline">\(R_i = 1\{p_i \leq \alpha_i\}\)</span> denotes a rejected hypothesis. The procedure strongly controls the FWER for arbitrarily dependent p-values.</p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span> is the same as that for <span class="math inline">\(\xi\)</span> for LORD given <a href="#LORD_gamma">here</a>.</p>
</div>
<div id="ADDIS-spending" class="section level3">
<h3 class="hasAnchor">
<a href="#ADDIS-spending" class="anchor"></a>ADDIS-spending</h3>
<p>The ADDIS-spending procedure strongly controls the FWER for independent p-values, and was proposed by Tian &amp; Ramdas (2019b). The procedure compensates for the power loss of Alpha-spending, by including both adapativity in the fraction of null hypotheses and the conservativeness of nulls.</p>
<p>ADDIS depends on constants <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\tau\)</span>, where <span class="math inline">\(\lambda &lt; \tau\)</span>. Here <span class="math inline">\(\tau \in (0,1)\)</span> represents the threshold for a hypothesis to be selected for testing: p-values greater than <span class="math inline">\(\tau\)</span> are implicitly `discarded’ by the procedure, while <span class="math inline">\(\lambda \in (0,1)\)</span> sets the threshold for a p-value to be a candidate for rejection: ADDIS-spending will never reject a p-value larger than <span class="math inline">\(\lambda\)</span>.</p>
<p>Note that the procedure controls the generalised familywise error rate (k-FWER) for <span class="math inline">\(k &gt; 1\)</span> if <span class="math inline">\(\alpha\)</span> is replaced by <span class="math inline">\(\min(1,k\alpha)\)</span>. Tian and Ramdas (2019b) also presented a version for handling local dependence, see the Section on Asynchronous testing below.</p>
<p>The default sequence of <span class="math inline">\(\gamma\)</span> for ADDIS-spending is the same as for SAFFRON given <a href="#SAFFRON_gamma">here</a>.</p>
</div>
<div id="accounting-for-dependent-p-values" class="section level3">
<h3 class="hasAnchor">
<a href="#accounting-for-dependent-p-values" class="anchor"></a>Accounting for dependent p-values</h3>
<p>As noted above, the LORD, SAFFRON, ADDIS and ADDIS-spending procedures assume independent p-values, while the LOND procedure is also valid under positive dependencies (like the Benjamini-Hochberg method, see below). Adjusted versions of LOND and LORD available for arbitrarily dependent p-values. Alpha-spending and online fallback also control the FWER and FDR for arbitrarily dependent p-values.</p>
<p>By way of comparison, the usual Benjamini-Hochberg method for controlling the FDR assumes that the p-values are positively dependent (PRDS). As an example, the PRDS is satisfied for multivariate normal test statistics with a positive correlation matrix). See Benjamini &amp; Yekutieli (2001) for further technical details.</p>
<hr>
</div>
</div>
<div id="asynchronous-testing" class="section level2">
<h2 class="hasAnchor">
<a href="#asynchronous-testing" class="anchor"></a>Asynchronous testing</h2>
<p>Zrnic <em>et al.</em> (2018) proposed procedures to control the modified FDR (mFDR) in the context of <em>asynchronous</em> testing, i.e. where each hypothesis test can itself be a sequential process and the tests can overlap in time. They presented asynchronous versions of the LOND, LORD and SAFFRON procedures for a variety of trial settings, including the following:</p>
<p>1: <strong>Asynchronous online mFDR control</strong>: This is for an asynchronous testing process, consisting of tests that start and finish at (potentially) random times. The discretised finish times of the test correspond to the decision times.</p>
<p>2: <strong>Online mFDR control under local dependence</strong>: For any <span class="math inline">\(t&gt;0\)</span> we allow the p-value <span class="math inline">\(p_t\)</span> to have arbitrary dependence on the previous <span class="math inline">\(L_t\)</span> p-values. The fixed sequence <span class="math inline">\(L_t\)</span> is referred to as `lags’.</p>
<p>3: <strong>mFDR control in asynchronous mini-batch testing</strong>: A mini-batch represents a grouping of tests run asynchronously which result in dependent p-values. Once a mini-batch of tests is fully completed, a new one can start, testing hypotheses independent of the previous batch.</p>
<hr>
</div>
<div id="variations-to-the-default-options" class="section level2">
<h2 class="hasAnchor">
<a href="#variations-to-the-default-options" class="anchor"></a>Variations to the default options</h2>
<p>In the following section, we consider the arguments that a typical user might consider amending for their analysis.</p>
<div id="common-arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#common-arguments" class="anchor"></a>Common arguments</h3>
<p>As a default, the <code>alpha</code> argument is set to 0.05, where <code>alpha</code> sets the overall significance level of the FDR of FWER controlling procedure. By convention, the standard significance level utilised is the 5%. However, there are applications where an alternate threshold could be considered. For example, a more stringent threshold might be appropriate when there are limited resources to follow up significant findings. A less stringent threshold might be appropriate when the downstream analysis is a global analysis which can tolerate a higher proportion of false positives.</p>
<p>To ensure correct interpretation of the dates provided there is a date.format argument. As a default, the date format is set to receive dates as year-month(00-12)-day(number). The following website provides clear guidance on symbols used to interpret the date information: <a href="https://www.statmethods.net/input/dates.html" class="uri">https://www.statmethods.net/input/dates.html</a></p>
<p>As a default, the <code>random</code> argument is set to <code>TRUE</code>. In this situation, the order of p-values in each batch (i.e. with the same date) are randomised. This is to avoid the risk of p-values being ordered post-hoc, which can lead to an inflation of the FDR. As the dataset grows the data is reprocessed. To ensure the consistency of the output (with the randomisation within the previous batches remaining the same), it is necessary to set the same <code>seed</code> for all analyses.</p>
<p>The user also has the option to turn off the randomisation step, by setting the <code>random</code> argument to <code>FALSE</code>. This approach would be appropriate if the user has both a date <em>and</em> a time stamp for the p-values, in which case the data should be ordered by date and time beforehand and then passed to a wrapper function. Another scenario would be when p-values within the batches are ordered using <em>independent</em> side information, so that hypotheses most likely to be rejected come first, which would potentially increase the power of the procedure (see Javanmard and Montanari (2018) and Li and Barber (2017)).</p>
</div>
<div id="lond" class="section level3">
<h3 class="hasAnchor">
<a href="#lond" class="anchor"></a>LOND</h3>
<p>As a default, the <code>dep</code> argument is set to <code>FALSE</code>. Alternatively, this can be set to <code>TRUE</code> and will implement the LOND procedure to guarantee FDR control for arbitrarily dependent p-values. This method will in general be more conservative.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.indep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LOND.html">LOND</a></span><span class="op">(</span><span class="va">sample.df</span><span class="op">)</span>    <span class="co"># for independent p-values</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.dep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LOND.html">LOND</a></span><span class="op">(</span><span class="va">sample.df</span>, dep<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># for dependent p-values</span>

<span class="co"># compare adjusted significance thresholds</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>independent <span class="op">=</span> <span class="va">results.indep</span><span class="op">$</span><span class="va">alphai</span>, dependent <span class="op">=</span> <span class="va">results.dep</span><span class="op">$</span><span class="va">alphai</span><span class="op">)</span>
<span class="co">#&gt;        independent    dependent</span>
<span class="co">#&gt;  [1,] 0.0026758385 0.0026758385</span>
<span class="co">#&gt;  [2,] 0.0011638206 0.0007758804</span>
<span class="co">#&gt;  [3,] 0.0009912499 0.0005406818</span>
<span class="co">#&gt;  [4,] 0.0008243606 0.0003956931</span>
<span class="co">#&gt;  [5,] 0.0006988870 0.0003060819</span>
<span class="co">#&gt;  [6,] 0.0006045900 0.0002467714</span>
<span class="co">#&gt;  [7,] 0.0005319444 0.0002051576</span>
<span class="co">#&gt;  [8,] 0.0007117838 0.0002618915</span>
<span class="co">#&gt;  [9,] 0.0006421423 0.0002269882</span>
<span class="co">#&gt; [10,] 0.0007796504 0.0002661860</span>
<span class="co">#&gt; [11,] 0.0007155186 0.0002369363</span>
<span class="co">#&gt; [12,] 0.0006610273 0.0002130140</span>
<span class="co">#&gt; [13,] 0.0006141682 0.0001931265</span>
<span class="co">#&gt; [14,] 0.0005734509 0.0001763616</span>
<span class="co">#&gt; [15,] 0.0005377472 0.0001620585</span></pre></div>
<p>The vector <code>betai</code> is supplied by default, but can optionally be specified by the user (as described above, see the formula for <span class="math inline">\(\beta_j\)</span> <a href="#LOND_beta">here</a>).</p>
</div>
<div id="lord" class="section level3">
<h3 class="hasAnchor">
<a href="#lord" class="anchor"></a>LORD</h3>
<p>The default version of LORD used is version ‘++’, but the user can optionally specify versions 3, ‘discard’ and ‘dep’ using the <code>version</code> argument (see <a href="#LORD">here</a> for further details about the different versions).</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD.plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span>, version<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD.discard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span>, version<span class="op">=</span><span class="st">'discard'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>; <span class="va">results.LORD.dep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LORD.html">LORD</a></span><span class="op">(</span><span class="va">sample.df</span>, version<span class="op">=</span><span class="st">'dep'</span><span class="op">)</span> 

<span class="co"># compare adjusted significance thresholds</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>LORD.plus <span class="op">=</span> <span class="va">results.LORD.plus</span><span class="op">$</span><span class="va">alphai</span>,
    LORD3 <span class="op">=</span> <span class="va">results.LORD3</span><span class="op">$</span><span class="va">alphai</span>,
    LORD.discard  <span class="op">=</span> <span class="va">results.LORD.discard</span><span class="op">$</span><span class="va">alphai</span>,
    LORD.dep <span class="op">=</span> <span class="va">results.LORD.dep</span><span class="op">$</span><span class="va">alphai</span><span class="op">)</span>
<span class="co">#&gt;          LORD.plus        LORD3 LORD.discard     LORD.dep</span>
<span class="co">#&gt;  [1,] 0.0002675839 0.0002675839 0.0002675839 2.323935e-03</span>
<span class="co">#&gt;  [2,] 0.0024664457 0.0026615183 0.0011285264 1.107961e-02</span>
<span class="co">#&gt;  [3,] 0.0005732818 0.0005787961 0.0002823266 1.855138e-03</span>
<span class="co">#&gt;  [4,] 0.0004872805 0.0004929725 0.0002394680 6.924756e-04</span>
<span class="co">#&gt;  [5,] 0.0004059066 0.0004099744 0.0001998165 3.540284e-04</span>
<span class="co">#&gt;  [6,] 0.0003447286 0.0003475734 0.0001700069 2.138161e-04</span>
<span class="co">#&gt;  [7,] 0.0002986627 0.0003006772 0.0001475152 1.430752e-04</span>
<span class="co">#&gt;  [8,] 0.0029389397 0.0048133468 0.0014680343 1.685669e-04</span>
<span class="co">#&gt;  [9,] 0.0008168502 0.0010467508 0.0014680343 1.270096e-04</span>
<span class="co">#&gt; [10,] 0.0033835974 0.0069079880 0.0017451837 1.560048e-04</span>
<span class="co">#&gt; [11,] 0.0011873999 0.0015022690 0.0006438778 1.255746e-04</span>
<span class="co">#&gt; [12,] 0.0010225858 0.0012795133 0.0006438778 1.034364e-04</span>
<span class="co">#&gt; [13,] 0.0008785607 0.0010640913 0.0006438778 8.681710e-05</span>
<span class="co">#&gt; [14,] 0.0007679398 0.0009021289 0.0005497556 7.401343e-05</span>
<span class="co">#&gt; [15,] 0.0006820264 0.0007804097 0.0005497556 6.393279e-05</span></pre></div>
<p>By default <span class="math inline">\(w_0 = \alpha/10\)</span> and (for LORD 3 and LORD dep) <span class="math inline">\(b0 = alpha - w0\)</span>, but these parameters can optionally be specified by the user subject to the requirements that <span class="math inline">\(0 \leq w_0 \leq \alpha\)</span>, <span class="math inline">\(b_0 &gt; 0\)</span> and <span class="math inline">\(w_0+b_0 \leq \alpha\)</span>.</p>
<p>The value of <code>gammai</code> is also supplied by default, but can optionally be specified by the user (as described above, see the formula for <span class="math inline">\(\gamma_j\)</span> <a href="#LORDdep_xi">here</a> for version=‘dep’ and <a href="#LORD_gamma">here</a> for all other versions of LORD).</p>
</div>
<div id="saffron" class="section level3">
<h3 class="hasAnchor">
<a href="#saffron" class="anchor"></a>SAFFRON</h3>
<p>By default <span class="math inline">\(w_0 = \alpha/2\)</span> and <span class="math inline">\(\lambda = 0.5\)</span>, but these parameters can optionally be specified by the user subject to the requirements that <span class="math inline">\(0 \leq w_0 &lt; \alpha\)</span> and <span class="math inline">\(0 &lt; \lambda &lt; 1\)</span>. The values of <code>gammai</code> are also supplied by default, but can optionally be specified by the user (as described above, see the formula for <span class="math inline">\(\gamma_j\)</span> <a href="#SAFFRON_gamma">here</a>).</p>
</div>
<div id="addis" class="section level3">
<h3 class="hasAnchor">
<a href="#addis" class="anchor"></a>ADDIS</h3>
<p>By default <span class="math inline">\(w_0 = \tau \lambda \alpha/2\)</span> and <span class="math inline">\(\lambda = \tau = 0.5\)</span>, but these parameters can optionally be specified by the user subject to the requirements that <span class="math inline">\(0 \leq w_0 &lt; \tau \lambda \alpha\)</span>, <span class="math inline">\(0 &lt; \lambda &lt; 1\)</span> and <span class="math inline">\(0 &lt; \tau &lt; 1\)</span>. The values of <code>gammai</code> are also supplied by default, but can optionally be specified by the user.</p>
</div>
<div id="alpha-spending-and-online-fallback" class="section level3">
<h3 class="hasAnchor">
<a href="#alpha-spending-and-online-fallback" class="anchor"></a>Alpha-spending and online fallback</h3>
<p>The values of <code>gammai</code> are supplied by default, but can optionally be specified by the user.</p>
</div>
<div id="addis-spending" class="section level3">
<h3 class="hasAnchor">
<a href="#addis-spending" class="anchor"></a>ADDIS-spending</h3>
<p>By default <span class="math inline">\(\lambda = 0.25\)</span> and <span class="math inline">\(\tau = 0.5\)</span>, but these parameters can optionally be specified by the user subject to the requirements that <span class="math inline">\(\lambda &lt; \tau\)</span>, <span class="math inline">\(0 &lt; \lambda &lt; 1\)</span> and <span class="math inline">\(0 &lt; \tau &lt; 1\)</span>. The values of <code>gammai</code> are also supplied by default, but can optionally be specified by the user.</p>
<hr>
</div>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>We would like to thank the IMPC team (via Jeremy Mason and Hamed Haseli Mashhadi) for useful discussions during the development of the package.</p>
<hr>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Aharoni, E. and Rosset, S. (2014). Generalized <span class="math inline">\(\alpha\)</span>-investing: definitions, optimality results and applications to public databases. <em>Journal of the Royal Statistical Society (Series B)</em>, 76(4):771–794.</p>
<p>Benjamini, Y., and Yekutieli, D. (2001). The control of the false discovery rate in multiple testing under dependency. <em>The Annals of Statistics</em>, 29(4):1165-1188.</p>
<p>Bourgon, R., Gentleman, R., and Huber, W. (2010). Independent filtering increases detection power for high-throughput experiments. <em>Proceedings of the National Academy of Sciences</em>, 107(21), 9546-9551.</p>
<p>Foster, D. and Stine R. (2008). <span class="math inline">\(\alpha\)</span>-investing: a procedure for sequential control of expected false discoveries. <em>Journal of the Royal Statistical Society (Series B)</em>, 29(4):429-444.</p>
<p>Ioannidis, J.P.A. (2005). Why most published research findings are false. <em>PLoS Medicine</em>, 2.8:e124.</p>
<p>Javanmard, A., and Montanari, A. (2015). On Online Control of False Discovery Rate. <em>arXiv preprint</em>, <a href="https://arxiv.org/abs/1502.06197" class="uri">https://arxiv.org/abs/1502.06197</a>.</p>
<p>Javanmard, A., and Montanari, A. (2018). Online Rules for Control of False Discovery Rate and False Discovery Exceedance. <em>Annals of Statistics</em>, 46(2):526-554.</p>
<p>Koscielny, G., <em>et al</em>. (2013). The International Mouse Phenotyping Consortium Web Portal, a unified point of access for knockout mice and related phenotyping data. <em>Nucleic Acids Research</em>, 42.D1:D802-D809.</p>
<p>Li, A., and Barber, F.G. (2017). Accumulation Tests for FDR Control in Ordered Hypothesis Testing. <em>Journal of the American Statistical Association</em>, 112(518):837-849.</p>
<p>Ramdas, A., Yang, F., Wainwright M.J. and Jordan, M.I. (2017). Online control of the false discovery rate with decaying memory. <em>Advances in Neural Information Processing Systems 30</em>, 5650-5659.</p>
<p>Ramdas, A., Zrnic, T., Wainwright M.J. and Jordan, M.I. (2018). SAFFRON: an adaptive algorithm for online control of the false discovery rate. <em>Proceedings of the 35th International Conference in Machine Learning</em>, 80:4286-4294.</p>
<p>Robertson, D.S. and Wason, J.M.S. (2018). Online control of the false discovery rate in biomedical research. <em>arXiv preprint</em>, <a href="https://arxiv.org/abs/1809.07292" class="uri">https://arxiv.org/abs/1809.07292</a>.</p>
<p>Robertson, D.S., Wildenhain, J., Javanmard, A. and Karp, N.A. (2019). Online control of the false discovery rate in biomedical research. <em>Bioinformatics</em>, 35:4196-4199, <a href="https://doi.org/10.1093/bioinformatics/btz191" class="uri">https://doi.org/10.1093/bioinformatics/btz191</a>.</p>
<p>Tian, J. and Ramdas, A. (2019a). ADDIS: an adaptive discarding algorithm for online FDR control with conservative nulls. <em>arXiv preprint</em>, <a href="https://arxiv.org/abs/1905.11465" class="uri">https://arxiv.org/abs/1905.11465</a>.</p>
<p>Tian, J. and Ramdas, A. (2019b). Online control of the familywise error rate. <em>arXiv preprint</em>, <a href="https://arxiv.org/abs/1910.04900" class="uri">https://arxiv.org/abs/1910.04900</a>.</p>
<p>Zrnic, T., Ramdas, A. and Jordan, M.I. (2018). Asynchronous Online Testing of Multiple Hypotheses. <em>arXiv preprint</em>, <a href="https://arxiv.org/abs/1812.05068" class="uri">https://arxiv.org/abs/1812.05068</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David S. Robertson, Aaditya Ramdas, Adel Javanmard, Andrea Montanari, Jinjin Tian, Tijana Zrnic, Natasha A. Karp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '4c638d00ee22961d7aab55c43dd0309d',
    indexName: 'onlinefdr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
