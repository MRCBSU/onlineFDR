<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>supLORD: Online control of the false discovery exceedance (FDX) and the 
FDR at stopping times — supLORD • onlineFDR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="supLORD: Online control of the false discovery exceedance (FDX) and the 
FDR at stopping times — supLORD" />
<meta property="og:description" content="Implements the supLORD procedure, which controls both FDX and FDR, including
the FDR at stopping times, as presented by Xu and Ramdas (2021)." />
<meta property="og:image" content="https://dsrobertson.github.io/onlineFDR/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">onlineFDR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/onlineFDR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/advanced-usage.html">Advanced usage of onlineFDR</a>
    </li>
    <li>
      <a href="../articles/theory.html">The theory behind onlineFDR</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>supLORD: Online control of the false discovery exceedance (FDX) and the 
FDR at stopping times</h1>
    
    <div class="hidden name"><code>supLORD.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implements the supLORD procedure, which controls both FDX and FDR, including
the FDR at stopping times, as presented by Xu and Ramdas (2021).</p>
    </div>

    <pre class="usage"><span class='fu'>supLORD</span><span class='op'>(</span>
  <span class='va'>d</span>,
  delta <span class='op'>=</span> <span class='fl'>0.05</span>,
  <span class='va'>eps</span>,
  <span class='va'>r</span>,
  <span class='va'>eta</span>,
  <span class='va'>rho</span>,
  <span class='va'>gammai</span>,
  random <span class='op'>=</span> <span class='cn'>TRUE</span>,
  display_progress <span class='op'>=</span> <span class='cn'>FALSE</span>,
  date.format <span class='op'>=</span> <span class='st'>"%Y-%m-%d"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>Either a vector of p-values, or a dataframe with three columns: an
identifier (`id'), date (`date') and p-value (`pval'). If no column of
dates is provided, then the p-values are treated as being ordered
sequentially with no batches.</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>The probability at which the FDP exceeds eps (at any time step
after making r rejections). Must be between 0 and 1, defaults to 0.05.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>The upper bound on the FDP. Must be between 0 and 1.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>The threshold of rejections after which the error control 
begins to apply. Must be a positive integer.</p></td>
    </tr>
    <tr>
      <th>eta</th>
      <td><p>Controls the pace at which wealth is spent as a function of the 
algorithm's current wealth. Must be a positive real number.</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>Controls the length of time before the spending sequence exhausts 
the wealth earned from a rejection. Must be a positive integer.</p></td>
    </tr>
    <tr>
      <th>gammai</th>
      <td><p>Optional vector of \(\gamma_i\). A default is provided as
proposed by Javanmard and Montanari (2018).</p></td>
    </tr>
    <tr>
      <th>random</th>
      <td><p>Logical. If <code>TRUE</code> (the default), then the order of the
p-values in each batch (i.e. those that have exactly the same date) is
randomised.</p></td>
    </tr>
    <tr>
      <th>display_progress</th>
      <td><p>Logical. If <code>TRUE</code> prints out a progress bar for the algorithm runtime.</p></td>
    </tr>
    <tr>
      <th>date.format</th>
      <td><p>Optional string giving the format that is used for dates.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>d.out</dt><dd><p>A dataframe with the original data <code>d</code> (which
  will be reordered if there are batches and <code>random = TRUE</code>), the
  supLORD-adjusted significance thresholds \(\alpha_i\) and the indicator
  function of discoveries <code>R</code>. Hypothesis \(i\) is rejected if the
  \(i\)-th p-value is less than or equal to \(\alpha_i\), in which case
  <code>R[i] = 1</code>  (otherwise <code>R[i] = 0</code>).</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function takes as its input either a vector of p-values or a dataframe
with three columns: an identifier (`id'), date (`date') and p-value (`pval').
The case where p-values arrive in batches corresponds to multiple instances
of the same date. If no column of dates is provided, then the p-values are
treated as being ordered sequentially with no batches.</p>
<p>The supLORD procedure provably controls the FDX for p-values that are 
conditionally superuniform under the null. supLORD also controls the supFDR 
and hence the FDR (even at stopping times). Given an overall significance
level \(\alpha\), we choose a sequence of non-negative non-increasing
numbers \(\gamma_i\) that sum to 1.</p>
<p>supLORD requires the user to specify r, a threshold of rejections after which
the error control begins to apply, eps, the upper bound on the false 
discovery proportion (FDP), and delta, the probability at which the FDP
exceeds eps at any time step after making r rejections. As well, the user
should specify the variables eta, which controls the pace at which wealth is 
spent (as a function of the algorithm's current wealth), and rho, which 
controls the length of time before the spending sequence exhausts 
the wealth earned from a rejection.</p>
<p>Further details of the supLORD procedure can be found in Xu and Ramdas (2021).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Xu, Z. and Ramdas, A. (2021). Dynamic Algorithms for Online 
Multiple Testing. <em>arXiv preprint</em>, 
<a href='https://arxiv.org/abs/2010.13953'>https://arxiv.org/abs/2010.13953</a>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span><span class='op'>)</span>
<span class='va'>Z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>N</span>, mean <span class='op'>=</span> <span class='fl'>3</span><span class='op'>*</span><span class='va'>B</span><span class='op'>)</span>
<span class='va'>pval</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Z</span><span class='op'>)</span>

<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>supLORD</span><span class='op'>(</span><span class='va'>pval</span>, eps<span class='op'>=</span><span class='fl'>0.15</span>, r<span class='op'>=</span><span class='fl'>30</span>, eta<span class='op'>=</span><span class='fl'>0.05</span>, rho<span class='op'>=</span><span class='fl'>30</span>, random<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              d       alphai R
#&gt; 1 4.691912e-01 0.0019301522 0
#&gt; 2 6.167166e-01 0.0004197471 0
#&gt; 3 3.462711e-02 0.0003575072 0
#&gt; 4 1.300690e-03 0.0002973164 0
#&gt; 5 1.606961e-01 0.0002520627 0
#&gt; 6 2.174486e-06 0.0002180533 1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>$</span><span class='va'>R</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 390</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David S. Robertson, Lathan Liou, Aaditya Ramdas, Natasha A. Karp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '4c638d00ee22961d7aab55c43dd0309d',
    indexName: 'onlinefdr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


