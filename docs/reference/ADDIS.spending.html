<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS.spending • onlineFDR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="ADDIS-spending: Adaptive discarding algorithm for online FWER control — ADDIS.spending" />
<meta property="og:description" content="Implements the ADDIS algorithm for online FWER control, where ADDIS stands
for an ADaptive algorithm that DIScards conservative nulls, as presented by
Tian and Ramdas (2019b). The procedure compensates for the power loss of
Alpha-spending, by including both adapativity in the fraction of null
hypotheses and the conservativeness of nulls." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">onlineFDR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/onlineFDR-vignette.html">Managing multiple testing challenges with sequential inference using the onlineFDR package</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ADDIS-spending: Adaptive discarding algorithm for online FWER control</h1>
    
    <div class="hidden name"><code>ADDIS.spending.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implements the ADDIS algorithm for online FWER control, where ADDIS stands
for an ADaptive algorithm that DIScards conservative nulls, as presented by
Tian and Ramdas (2019b). The procedure compensates for the power loss of
Alpha-spending, by including both adapativity in the fraction of null
hypotheses and the conservativeness of nulls.</p>
    </div>

    <pre class="usage"><span class='fu'>ADDIS.spending</span>(<span class='no'>pval</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='no'>gammai</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>dep</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>lags</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pval</th>
      <td><p>A vector of p-values.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Overall significance level of the procedure, the default is
0.05.</p></td>
    </tr>
    <tr>
      <th>gammai</th>
      <td><p>Optional vector of \(\gamma_i\). A default is provided with
\(\gamma_j\) proportional to \(1/j^(1.6)\).</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Optional parameter that sets the threshold for `candidate'
hypotheses. Must be between 0 and 1, defaults to 0.25.</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>Optional threshold for hypotheses to be selected for testing. Must
be between 0 and 1, defaults to 0.5.</p></td>
    </tr>
    <tr>
      <th>dep</th>
      <td><p>Logical. If <code>TRUE</code> runs the version for locally dependent 
p-values</p></td>
    </tr>
    <tr>
      <th>lags</th>
      <td><p>A vector of lags or the hypothesis tests, this is required if
<code>dep=TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>d.out</dt><dd><p>A dataframe with the original p-values <code>pval</code>, the
  adjusted testing levels \(\alpha_i\) and the indicator function of
  discoveries <code>R</code>. Hypothesis \(i\) is rejected if the \(i\)-th
  p-value is less than or equal to \(\alpha_i\), in which case <code>R[i] =
  1</code>  (otherwise <code>R[i] = 0</code>).</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function takes as its input a vector of p-values. Given an overall
significance level \(\alpha\), ADDIS depends on constants \(\lambda\) and
\(\tau\), where \(\lambda &lt; \tau\). Here \(\tau \in (0,1)\) represents
the threshold for a hypothesis to be selected for testing: p-values greater
than \(\tau\) are implicitly `discarded' by the procedure, while
\(\lambda \in (0,1)\) sets the threshold for a p-value to be a candidate
for rejection: ADDIS-spending will never reject a p-value larger than
\(\lambda\). The algorithms also require a sequence of non-negative
non-increasing numbers \(\gamma_i\) that sum to 1.</p>
<p>The ADDIS-spending procedure provably controls the FWER in the strong sense
for independent p-values. Note that the procedure also controls the
generalised familywise error rate (k-FWER) for \(k &gt; 1\) if \(\alpha\) is
replaced by min(\(1, k\alpha\)).</p>
<p>Tian and Ramdas (2019b) also presented a version for handling local
dependence. More precisely, for any \(t&gt;0\) we allow the p-value \(p_t\)
to have arbitrary dependence on the previous \(L_t\) p-values. The fixed
sequence \(L_t\) is referred to as `lags', and is given as the input
<code>lags</code> for this version of the ADDIS-spending algorithm.</p>
<p>Further details of the ADDIS-spending algorithms can be found in Tian and
Ramdas (2019b).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Tian, J. and Ramdas, A. (2019b). Online control of the familywise error rate.
<em>arXiv preprint</em>, <a href='https://arxiv.org/abs/1910.04900'>https://arxiv.org/abs/1910.04900</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ADDIS.html'>ADDIS</a></code> provides online control of the FDR.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>pval</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2.90e-08</span>, <span class='fl'>0.06743</span>, <span class='fl'>3.51e-04</span>, <span class='fl'>0.0154</span>, <span class='fl'>0.04723</span>,
        <span class='fl'>3.60e-05</span>, <span class='fl'>0.79149</span>, <span class='fl'>0.27201</span>, <span class='fl'>0.28295</span>, <span class='fl'>7.59e-06</span>,
        <span class='fl'>0.69274</span>, <span class='fl'>0.30443</span>, <span class='fl'>0.00136</span>, <span class='fl'>0.82342</span>, <span class='fl'>5.4757e-04</span>)

<span class='fu'>ADDIS.spending</span>(<span class='no'>pval</span>)</div><div class='output co'>#&gt;          pval       alphai R
#&gt; 1  2.9000e-08 0.0054686271 1
#&gt; 2  6.7430e-02 0.0054686271 0
#&gt; 3  3.5100e-04 0.0054686271 1
#&gt; 4  1.5400e-02 0.0054686271 0
#&gt; 5  4.7230e-02 0.0054686271 0
#&gt; 6  3.6000e-05 0.0054686271 1
#&gt; 7  7.9149e-01 0.0054686271 0
#&gt; 8  2.7201e-01 0.0054686271 0
#&gt; 9  2.8295e-01 0.0018039742 0
#&gt; 10 7.5900e-06 0.0009429405 1
#&gt; 11 6.9274e-01 0.0009429405 0
#&gt; 12 3.0443e-01 0.0009429405 0
#&gt; 13 1.3600e-03 0.0005950895 0
#&gt; 14 8.2342e-01 0.0005950895 0
#&gt; 15 5.4757e-04 0.0005950895 1</div><div class='input'>
<span class='fu'>ADDIS.spending</span>(<span class='no'>pval</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>lags</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fl'>15</span>)) <span class='co'># Same as above</span></div><div class='output co'>#&gt;          pval       alphai R
#&gt; 1  2.9000e-08 0.0054686271 1
#&gt; 2  6.7430e-02 0.0054686271 0
#&gt; 3  3.5100e-04 0.0054686271 1
#&gt; 4  1.5400e-02 0.0054686271 0
#&gt; 5  4.7230e-02 0.0054686271 0
#&gt; 6  3.6000e-05 0.0054686271 1
#&gt; 7  7.9149e-01 0.0054686271 0
#&gt; 8  2.7201e-01 0.0054686271 0
#&gt; 9  2.8295e-01 0.0018039742 0
#&gt; 10 7.5900e-06 0.0009429405 1
#&gt; 11 6.9274e-01 0.0009429405 0
#&gt; 12 3.0443e-01 0.0009429405 0
#&gt; 13 1.3600e-03 0.0005950895 0
#&gt; 14 8.2342e-01 0.0005950895 0
#&gt; 15 5.4757e-04 0.0005950895 1</div><div class='input'>
<span class='fu'>ADDIS.spending</span>(<span class='no'>pval</span>, <span class='kw'>dep</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>lags</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>15</span>)) <span class='co'># Locally dependent</span></div><div class='output co'>#&gt;          pval       alphai R
#&gt; 1  2.9000e-08 0.0054686271 1
#&gt; 2  6.7430e-02 0.0018039742 0
#&gt; 3  3.5100e-04 0.0018039742 1
#&gt; 4  1.5400e-02 0.0018039742 0
#&gt; 5  4.7230e-02 0.0018039742 0
#&gt; 6  3.6000e-05 0.0018039742 1
#&gt; 7  7.9149e-01 0.0018039742 0
#&gt; 8  2.7201e-01 0.0018039742 0
#&gt; 9  2.8295e-01 0.0018039742 0
#&gt; 10 7.5900e-06 0.0009429405 1
#&gt; 11 6.9274e-01 0.0005950895 0
#&gt; 12 3.0443e-01 0.0005950895 0
#&gt; 13 1.3600e-03 0.0005950895 0
#&gt; 14 8.2342e-01 0.0004164149 0
#&gt; 15 5.4757e-04 0.0004164149 0</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David S. Robertson, Aaditya Ramdas, Adel Javanmard, Andrea Montanari, Jinjin Tian, Tijana Zrnic, Natasha A. Karp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '4c638d00ee22961d7aab55c43dd0309d',
    indexName: 'onlinefdr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


